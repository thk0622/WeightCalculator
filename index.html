<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Weight Calculator</title>
  <style>
    :root { --primary: purple; --danger:purple; }
    * { box-sizing: border-box; }
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0;
      display: flex; justify-content: center; align-items: center;
      min-height: 100vh; background-color: #f4f4f4;
    }
    .container {
      background: #ffffff; padding: 20px; border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      max-width: 420px; width: 92%;
    }
    h1 { font-size: 20px; margin-bottom: 16px; color: #333; text-align: center; }
    label { font-weight: bold; margin-top: 10px; display: block; }
    input[type="number"], select {
      width: 100%; padding: 10px; margin: 8px 0;
      border: 1px solid #ccc; border-radius: 8px; font-size: 16px;
    }
    button {
      width: 100%; padding: 12px; font-size: 16px;
      background-color: var(--primary); color: white; border: none;
      border-radius: 8px; cursor: pointer; margin-top: 10px;
    }
    button:hover { background-color: #483D8B; }
    .reset-btn { background-color: var(--danger); }
    .reset-btn:hover { background-color: #483D8B; }

    ul { padding-left: 0; margin: 10px 0 0; }
    ul li {
      list-style: none; padding: 8px 10px; background: #f1f1f1;
      margin: 6px 0; border-radius: 6px; display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    .item-label { font-size: 14px; }
    .remove-btn {
      background: transparent; color: #dc3545; border: none;
      font-size: 18px; width: auto; padding: 0 6px; cursor: pointer; line-height: 1;
    }
    .remove-btn:active { transform: scale(0.96); }

    .stats {
      margin-top: 12px; background:#fafafa; border:1px solid #eee; border-radius:8px; padding:10px;
      display:grid; grid-template-columns: 1fr 1fr; gap:8px; font-size:14px;
    }
    .stats div { display:flex; justify-content:space-between; }
    .result {
      margin-top: 12px; font-size: 18px; font-weight: bold; color: #333; text-align: center;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Weight Calculator (kg)</h1>

    <label for="observedWeight">Observed Weight:</label>
    <input type="number" id="observedWeight" placeholder="Enter total weight (kg)" step="0.01" min="0" />

    <label for="objectDropdown">Objects:</label>
    <select id="objectDropdown">
      <option value="" disabled selected>Select an object</option>
    </select>
    <button id="addWeightBtn">Add Object</button>

    <ul id="objectWeightsList"></ul>

    <div class="stats">
      <div><span>Total objects (tare)</span><strong id="tare">0.00 kg</strong></div>
      <div><span>Observed</span><strong id="obs">0.00 kg</strong></div>
    </div>
    <div class="result" id="result">Net Weight: 0.00 kg</div>

    <button id="resetBtn" class="reset-btn">Reset</button>
  </div>

 <script>
  document.addEventListener('DOMContentLoaded', () => {
    // --- Object database (kg) ---
    const objectDatabase = {
      "Blanket": 0.675,
      "Pillow (with case)": 0.63,
      "Pillowcase Only": 0.035,
      "Washcloth": 0.11,
      "Towel": 0.215,
      "Z-flo Foam Pillow Large": 1.25,
      "Z-flo Foam Pillow Small": 0.66,
      "WAFFLE pillow": 0.255,
      "Full Swing": 1.8,
      "Bed pad": 0.585,
      "Standard Gown": 0.317,
      "Bariatric Gown": 0.417,
      "Bed Sheet": 0.38,
      "Bariatric Bed Sheet": 0.79,
      "Dryflow pad (standard size)": 0.12,
      "Dryflow pad (full lenght)": 0.199,
      "Chux or blue pads": 0.025,
      "Locked Restraint (each)": 0.393,
      "Restraint (pair)": 0.13,
      "Bariatric Sock (pair)": 0.08,
      "Gray Socks (pair)": 0.044,
      "Abductor pillow": 1.05,
      "heel Medix boot + wedge, standard": 0.469,
      "Sage Boot, pediatric": 0.333,
      "PFS small": 0.6,
      "PFS medium": 0.7,
      "PFS large": 0.8,
      "Knee Immobilizer 20 in": 0.5,
      "Knee Immobilizer 22 in": 0.8,
      "Freedom Splint": 0.165,
      "Mittens, Adult": 0.165,
      "Waist Restraint": 0.538,
      "SCD full set with machine": 6.6,
      "Cooling Blanket": 1.5,
      "Male Urinal": 0.04,
      "Female Urinal": 0.081,
      "Seizure pads (2)": 1.680,
      "Prevalon air pump": 6.5,
      "Airtap Sheet": 0.98,
      "Airtap Sheet XXL": 0.95,
      "Airtap Wedge (2 piece)": 0.871
    };

    // --- Elements ---
    const objectDropdown = document.getElementById('objectDropdown');
    const listEl = document.getElementById('objectWeightsList');
    const resultEl = document.getElementById('result');
    const tareEl = document.getElementById('tare') || (()=>{ const d=document.createElement('div'); return d; })();
    const obsEl = document.getElementById('obs') || (()=>{ const d=document.createElement('div'); return d; })();
    const observedWeightInput = document.getElementById('observedWeight');
    const addWeightBtn = document.getElementById('addWeightBtn');
    const resetBtn = document.getElementById('resetBtn');

    // --- State ---
    let items = []; // [{ name, weight }]
    let observed = 0;

    // Populate dropdown safely
    function populateDropdown() {
      try {
        objectDropdown.innerHTML = '<option value="" disabled selected>Select an object</option>';
        const entries = Object.entries(objectDatabase);
        if (!entries.length) throw new Error('Empty object database');
        for (const [name, weight] of entries) {
          const opt = document.createElement('option');
          opt.value = name;
          opt.textContent = `${name} (${weight} kg)`;
          objectDropdown.appendChild(opt);
        }
      } catch (e) {
        // Visible fallback if something blocks JS on device
        objectDropdown.innerHTML = '<option value="" disabled selected>Objects unavailable</option>';
      }
    }

    // Recalc & render
    function recalcAndRender() {
      const tare = items.reduce((sum, it) => sum + it.weight, 0);
      const net = (observed || 0) - tare;

      if (tareEl) tareEl.textContent = `${tare.toFixed(2)} kg`;
      if (obsEl)  obsEl.textContent  = `${(observed || 0).toFixed(2)} kg`;
      if (resultEl) resultEl.textContent = `Net Weight: ${net.toFixed(2)} kg`;

      listEl.innerHTML = '';
      items.forEach((it, idx) => {
        const li = document.createElement('li');

        const lbl = document.createElement('span');
        lbl.className = 'item-label';
        lbl.textContent = `${it.name}: ${it.weight.toFixed(2)} kg`;

        const removeBtn = document.createElement('button');
        removeBtn.className = 'remove-btn';
        removeBtn.setAttribute('aria-label', 'Remove item');
        removeBtn.textContent = 'Ã—';
        removeBtn.onclick = () => {
          items.splice(idx, 1);
          recalcAndRender();
        };

        li.append(lbl, removeBtn);
        listEl.appendChild(li);
      });
    }

    // Events
    addWeightBtn.addEventListener('click', () => {
      const selected = objectDropdown.value;
      if (!selected) { alert('Please select an object.'); return; }
      const weight = objectDatabase[selected];
      // guard if key missing (e.g., old cached code)
      if (typeof weight !== 'number') { alert('Object weight not found. Try a hard refresh.'); return; }
      items.push({ name: selected, weight });
      recalcAndRender();
      // Do NOT clear dropdown; user can tap Add again
    });

    observedWeightInput.addEventListener('input', () => {
      const v = parseFloat(observedWeightInput.value);
      observed = Number.isFinite(v) && v >= 0 ? v : 0;
      recalcAndRender();
    });

    resetBtn.addEventListener('click', () => {
      if (!confirm('Clear observed weight and all objects?')) return;
      observed = 0;
      items = [];
      observedWeightInput.value = '';
      recalcAndRender();
    });

    // Init
    populateDropdown();
    recalcAndRender();
  });
</script>
</body>
</html>




